#include <cmath>

#include <isce/core/Constants.h>
#include <isce/core/Vector.h>

namespace isce { namespace focus {

CUDA_HOSTDEV
inline
double bistaticDelay(const isce::core::Vec3 & p,
                     const isce::core::Vec3 & v,
                     const isce::core::Vec3 & x)
{
    constexpr static double c = isce::core::speed_of_light<double>;
    isce::core::Vec3 r = x - p;
    return 2. * (r.dot(v) - c * r.norm()) / (v.squaredNorm() - std::pow(c, 2));
}

}}
